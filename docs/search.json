[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "",
    "section": "",
    "text": "This document explore possible associations between undertrition in children with the Standardised Precipitation Evapotranspiration Index (SPEI) of municipalities in Brazil durting 2008-2019 period. It is part of the Sustentarea Research and Extension Group’s project titled Global Syndemic: The Impact of Anthropogenic Climate Change on the Health and Nutrition of Children Under Five Years Old Served by Brazil’s Public Health System (SUS).\n\n\n\n\n\n\nPlease note that this is a preliminary report intended to support decision-making and may not include all the details of the analysis."
  },
  {
    "objectID": "index.html#overview",
    "href": "index.html#overview",
    "title": "",
    "section": "",
    "text": "This document explore possible associations between undertrition in children with the Standardised Precipitation Evapotranspiration Index (SPEI) of municipalities in Brazil durting 2008-2019 period. It is part of the Sustentarea Research and Extension Group’s project titled Global Syndemic: The Impact of Anthropogenic Climate Change on the Health and Nutrition of Children Under Five Years Old Served by Brazil’s Public Health System (SUS).\n\n\n\n\n\n\nPlease note that this is a preliminary report intended to support decision-making and may not include all the details of the analysis."
  },
  {
    "objectID": "index.html#methods",
    "href": "index.html#methods",
    "title": "",
    "section": "Methods",
    "text": "Methods\nApproach and procedure method\nThe analysis will rely solely on a visual inspection of the data. If necessary, additional analysis and updates will be incorporated into this report later.\nSource of data/information\nThe data used in this analysis have as sources:\n\nThe Brazilian Institute of Geography and Statistics (IBGE) Automatic Retrieval System (SIDRA), for data on GDP per capita.\nBrazil’s Food and Nutrition Surveillance System (SISVAN) (link to SISVAN, for data on malnutrition.\n\nWorldClim, for data on bioclimatic variables, which allowed us to calculate the Standardised Precipitation Evapotranspiration Index (SPEI) for municipalities in Brazil.\nData wrangling\nThe data wrangling and analysis followed the data science framework outlined by Hadley Wickham et al. (Wickham et al., 2023), as illustrated in Figure 1.\n\n\nFigure 1: Model of the data science process created by Wickham, Çetinkaya-Runde, and Grolemund (2023).\n\n\nSource: Reproduced from Wickham et al. (2023).\n\n\n\nAll the analyses are 100% reproducible and can be run again at any time. See the README file on the code repository to learn how to run them."
  },
  {
    "objectID": "index.html#setting-the-enviroment",
    "href": "index.html#setting-the-enviroment",
    "title": "",
    "section": "Setting the Enviroment",
    "text": "Setting the Enviroment\n\nCodelibrary(beepr)\nlibrary(cli)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(glmmTMB)\nlibrary(janitor)\nlibrary(lme4)\nlibrary(magrittr)\nlibrary(mgcv)\nlibrary(patchwork)\nlibrary(polyglotr)\nlibrary(prettycheck) # github.com/danielvartan/prettycheck\nlibrary(readxl)\nlibrary(stats)\nlibrary(stringr)\nlibrary(tidyr)"
  },
  {
    "objectID": "index.html#loading-functions",
    "href": "index.html#loading-functions",
    "title": "",
    "section": "Loading functions",
    "text": "Loading functions\n\nCodesource(here::here(\"R\", \"coef_mean.R\"))\nsource(here::here(\"R\", \"model_gamm_misfs.R\"))\nsource(here::here(\"R\", \"plot_gamm.R\"))\nsource(here::here(\"R\", \"utils.R\"))\nsource(here::here(\"R\", \"utils-plots.R\"))"
  },
  {
    "objectID": "index.html#importing-and-tidying-the-data",
    "href": "index.html#importing-and-tidying-the-data",
    "title": "",
    "section": "Importing and Tidying the Data",
    "text": "Importing and Tidying the Data\nGDP Data\n\nCodegdp_data &lt;- \n  here::here(\"data\", \"PIB dos Municípios - base de dados 2010-2021.xlsx\") |&gt;\n  readxl::read_excel(col_types = \"text\") |&gt;\n  janitor::clean_names() |&gt;\n  dplyr::select(\n    ano, \n    codigo_do_municipio, \n    produto_interno_bruto_per_capita_a_precos_correntes_r_1_00\n  ) |&gt;\n  dplyr::rename(\n    year = ano,\n    municipality_code = codigo_do_municipio,\n    gdp_per_capita = \n      produto_interno_bruto_per_capita_a_precos_correntes_r_1_00,\n  ) |&gt;\n  dplyr::mutate(\n    year = as.integer(year),\n    municipality_code = \n      municipality_code |&gt;\n      stringr::str_sub(end = -2) |&gt;\n      as.integer(),\n    gdp_per_capita = as.numeric(gdp_per_capita)\n  )\n\ngdp_data\n\n\n  \n\n\n\nNutrition Data\n\nCodenutrition_data &lt;-\n  here::here(\"data\", \"Banco_dados_malnutritio_clima - Adaptado.csv\") |&gt;\n  readr::read_csv(col_types = readr::cols(.default = \"c\")) |&gt;\n  dplyr::mutate(\n    dplyr::across(\n      .cols = dplyr::everything(),\n      .fns = ~ \n        iconv(.x, from = \"UTF-8\", to = \"iso-8859-1\") |&gt;\n        readr::parse_guess()\n    )\n  ) |&gt;\n  janitor::clean_names() |&gt;\n  dplyr::rename(\n    year = ano,\n    municipality_code = code_muni\n  ) |&gt;\n  dplyr::mutate(\n    year = as.integer(year),\n    municipality_code = as.integer(municipality_code),\n    cobrs = as.numeric(cobrs)\n  )\n#&gt; New names:\n#&gt; • `` -&gt; `...1`\n\nnutrition_data\n\n\n  \n\n\n\nSPEI Data\n\nCodespei_data &lt;- \n  here::here(\"data\", \"spei_Extreme_drought_event_municipality_year2.csv\") |&gt;\n  readr::read_csv(col_types = readr::cols(.default = \"c\")) |&gt;\n  janitor::clean_names() |&gt;\n  dplyr::rename(\n    municipality_code = code_muni,\n    municipality_name = name_muni\n  ) |&gt;\n  dplyr::select(\n    municipality_code, \n    dplyr::starts_with(\"spei_12m_20\")\n  ) |&gt;\n  dplyr::mutate(\n    dplyr::across(\n      .cols = dplyr::starts_with(\"spei_12m_20\"),\n      .fns = as.numeric\n    )\n  ) |&gt;\n  tidyr::pivot_longer(\n    cols = starts_with(\"spei_12m_20\"),\n    names_to = \"year\",\n    values_to = \"spei_12m\"\n  ) |&gt;\n  dplyr::mutate(\n    municipality_code = \n      municipality_code |&gt;\n      substr(1, nchar(as.character(municipality_code)) - 1) |&gt;\n      as.integer(),\n    year = \n      gsub(\"spei_12m_\", \"\", year) |&gt;\n      as.integer(),\n  )\n  \nspei_data\n\n\n  \n\n\n\nAnalysis Data\n\nCodedata &lt;- \n  gdp_data |&gt;\n  dplyr::full_join(\n    y = nutrition_data,\n    by = c(\"year\", \"municipality_code\")\n  ) |&gt;\n  dplyr::left_join(\n    spei_data,\n    by = c(\"year\", \"municipality_code\")\n  )\n\ndata"
  },
  {
    "objectID": "index.html#checking-for-muncipalities-with-minimum-5-cover-from-sisvan",
    "href": "index.html#checking-for-muncipalities-with-minimum-5-cover-from-sisvan",
    "title": "",
    "section": "Checking for Muncipalities With Minimum 5% Cover from SISVAN",
    "text": "Checking for Muncipalities With Minimum 5% Cover from SISVAN\n\ndata |&gt;\n  dplyr::pull(cobrs) %&gt;%\n  sum(. &lt; 0.05, na.rm = TRUE)\n#&gt; [1] 29680.3019\n\n\ndata |&gt;\n  dplyr::pull(cobrs) %&gt;%\n  sum(. &gt; 1, na.rm = TRUE)\n#&gt; [1] 30664.3019\n\n\ndata &lt;- \n  data |&gt;\n  dplyr::filter(cobrs &gt;= 0.05)\n\ndata\n\n\n  \n\n\n\n\nmin(data$spei_12m)\n#&gt; [1] -1.751599753\n\n\nmax(data$spei_12m)\n#&gt; [1] 1.026890197"
  },
  {
    "objectID": "index.html#generalized-linear-mixed-model-glmm",
    "href": "index.html#generalized-linear-mixed-model-glmm",
    "title": "",
    "section": "Generalized Linear Mixed Model (GLMM)",
    "text": "Generalized Linear Mixed Model (GLMM)\nMBEPR – Very Short Stature for Age (Muito Baixa Estatura Para a Idade)\n\n\n\n\n\n\nSee https://cran.r-project.org/web/packages/glmmTMB/vignettes/troubleshooting.html to learn more about the model warnings.\n\n\n\n\nmbepr_model &lt;- glmmTMB::glmmTMB(\n  mbepr ~ spei_12m + gdp_per_capita + (1 | year),\n  data = data,\n  family = glmmTMB::betabinomial(link = \"logit\"),\n  control = glmmTMB::glmmTMBControl(\n    optimizer = optim, \n    optArgs = list(method = \"BFGS\")\n  )\n)\n#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial\n#&gt; glm!\n#&gt; Warning in finalizeTMB(TMBStruc, obj, fit, h, data.tmb.old): Model\n#&gt; convergence problem; non-positive-definite Hessian matrix. See\n#&gt; vignette('troubleshooting')\n\nmbepr_model\n#&gt; Formula:          mbepr ~ spei_12m + gdp_per_capita + (1 | year)\n#&gt; Data: data\n#&gt;      AIC      BIC   logLik df.resid \n#&gt;       NA       NA       NA    54665 \n#&gt; Random-effects (co)variances:\n#&gt; \n#&gt; Conditional model:\n#&gt;  Groups Name        Std.Dev.\n#&gt;  year   (Intercept) 1.512832\n#&gt; \n#&gt; Number of obs: 54670 / Conditional model: year, 10\n#&gt; \n#&gt; Dispersion parameter for betabinomial family (): 5.2e+177 \n#&gt; \n#&gt; Fixed Effects:\n#&gt; \n#&gt; Conditional model:\n#&gt;      (Intercept)          spei_12m    gdp_per_capita  \n#&gt; -0.5702246509759  -5.7450764201136   0.0000008241382\n\n\nCodeoverdispersion_test &lt;- \n  mbepr_model |&gt;\n  stats::residuals(type = \"pearson\") %&gt;%\n  `^`(2) %&gt;%\n  `/`(mbepr_model$df.residual) |&gt;\n  sum()\n\n\n\ncli::cli_inform(\"Overdispersion statistic: {overdispersion_test}\\n\")\n#&gt; Overdispersion statistic: 0\n\nif (overdispersion_test &gt; 1.5) {\n  cli::cli_inform(\"There might still be overdispersion in the model.\\n\")\n}\n\n\nCodedplyr::tibble(\n  fitted = stats::fitted(mbepr_model),\n  residuals = stats::residuals(mbepr_model, type = \"pearson\")\n) |&gt;\n  ggplot2::ggplot(ggplot2::aes(x = fitted, y = residuals)) +\n  ggplot2::geom_point(alpha = 0.5) +\n  ggplot2::geom_hline(\n    yintercept = 0, \n    color = get_brand_color(\"red\")\n  ) +\n  ggplot2::labs(\n    x = \"Fitted values\",\n    y = \"Pearson residuals\",\n    title = \"Residuals vs. Fitted\"\n  )\n\n\n\n\n\n\n\n\nCodedata |&gt;\n  ggplot2::ggplot(ggplot2::aes(x = spei_12m, y = mbepr)) +\n  ggplot2::geom_point(alpha = 0.5) +\n  ggplot2::geom_smooth(\n    method = \"glm\", \n    method.args = list(family = \"binomial\"), \n    se = TRUE, \n    color = get_brand_color(\"red\")\n  ) +\n  ggplot2::labs(\n    x = \"SPEI (12 months)\",\n    y = \"Probability of MBEPR\",\n    title = \"Relationship between SPEI_12m and MBEPR\"\n  )\n#&gt; `geom_smooth()` using formula = 'y ~ x'\n#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial\n#&gt; glm!\n\n\n\n\n\n\n\n\nCodedata |&gt;\n  tidyr::drop_na(gdp_per_capita, mbepr) |&gt;\n  ggplot2::ggplot(ggplot2::aes(x = gdp_per_capita, y = mbepr)) +\n  ggplot2::geom_point(alpha = 0.5) +\n  ggplot2::geom_smooth(\n    method = \"glm\", \n    method.args = list(family = \"binomial\"), \n    se = TRUE, \n    color = get_brand_color(\"red\")\n  ) +\n  ggplot2::labs(\n    x = \"GDP per capita\",\n    y = \"Very Short Stature for Age (MBEPR)\",\n    title = \"Relationship between GDP per capita and MBEPR\"\n  )\n#&gt; `geom_smooth()` using formula = 'y ~ x'\n#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial\n#&gt; glm!\n\n\n\n\n\n\n\nBEIPR – Short Stature for Age (Baixa Estatura Para Idade)\n\nbeipr_model &lt;- glmmTMB::glmmTMB(\n  beipr ~ spei_12m * gdp_per_capita + (1 | year),\n  data = data,\n  family = glmmTMB::betabinomial(link = \"logit\")\n)\n#&gt; Warning in eval(family$initialize): non-integer #successes in a binomial\n#&gt; glm!\n#&gt; Warning in finalizeTMB(TMBStruc, obj, fit, h, data.tmb.old): Model\n#&gt; convergence problem; non-positive-definite Hessian matrix. See\n#&gt; vignette('troubleshooting')\n#&gt; Warning in finalizeTMB(TMBStruc, obj, fit, h, data.tmb.old): Model\n#&gt; convergence problem; false convergence (8). See vignette('troubleshooting'),\n#&gt; help('diagnose')\n\nbeipr_model\n#&gt; Formula:          beipr ~ spei_12m * gdp_per_capita + (1 | year)\n#&gt; Data: data\n#&gt;      AIC      BIC   logLik df.resid \n#&gt;       NA       NA       NA    54664 \n#&gt; Random-effects (co)variances:\n#&gt; \n#&gt; Conditional model:\n#&gt;  Groups Name        Std.Dev.    \n#&gt;  year   (Intercept) 0.0006285806\n#&gt; \n#&gt; Number of obs: 54670 / Conditional model: year, 10\n#&gt; \n#&gt; Dispersion parameter for betabinomial family (): 2.47e+08 \n#&gt; \n#&gt; Fixed Effects:\n#&gt; \n#&gt; Conditional model:\n#&gt;             (Intercept)                 spei_12m           gdp_per_capita  \n#&gt;        -2.5915189700578         -0.0470766191722         -0.0000050110971  \n#&gt; spei_12m:gdp_per_capita  \n#&gt;        -0.0000004649216\n\n\nsummary(beipr_model)\n#&gt;  Family: betabinomial  ( logit )\n#&gt; Formula:          beipr ~ spei_12m * gdp_per_capita + (1 | year)\n#&gt; Data: data\n#&gt; \n#&gt;      AIC      BIC   logLik deviance df.resid \n#&gt;       NA       NA       NA       NA    54664 \n#&gt; \n#&gt; Random effects:\n#&gt; \n#&gt; Conditional model:\n#&gt;  Groups Name        Variance        Std.Dev.    \n#&gt;  year   (Intercept) 0.0000003951135 0.0006285806\n#&gt; Number of obs: 54670, groups:  year, 10\n#&gt; \n#&gt; Dispersion parameter for betabinomial family (): 2.47e+08 \n#&gt; \n#&gt; Conditional model:\n#&gt;                                 Estimate       Std. Error    z value\n#&gt; (Intercept)             -2.5915189700578  0.0245448649134 -105.58294\n#&gt; spei_12m                -0.0470766191722  0.0881768574492   -0.53389\n#&gt; gdp_per_capita          -0.0000050110971  0.0000008757264   -5.72222\n#&gt; spei_12m:gdp_per_capita -0.0000004649216  0.0000053852446   -0.08633\n#&gt;                               Pr(&gt;|z|)    \n#&gt; (Intercept)                 &lt; 2.22e-16 ***\n#&gt; spei_12m                       0.59342    \n#&gt; gdp_per_capita          0.000000010514 ***\n#&gt; spei_12m:gdp_per_capita        0.93120    \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nMAPER – Severe Thinness for Height (Magreza Acentuada Para a Estatura)\n\nmaper_model &lt;- glm(\n  maper ~ spei_12m * gdp_per_capita,\n  data = data,\n  family = quasibinomial(link = \"logit\")\n)\n\nmaper_model\n#&gt; \n#&gt; Call:  glm(formula = maper ~ spei_12m * gdp_per_capita, family = quasibinomial(link = \"logit\"), \n#&gt;     data = data)\n#&gt; \n#&gt; Coefficients:\n#&gt;             (Intercept)                 spei_12m           gdp_per_capita  \n#&gt;         -3.536476647077          -0.057882158222          -0.000011753764  \n#&gt; spei_12m:gdp_per_capita  \n#&gt;         -0.000005560497  \n#&gt; \n#&gt; Degrees of Freedom: 54669 Total (i.e. Null);  54666 Residual\n#&gt;   (10331 observations deleted due to missingness)\n#&gt; Null Deviance:       1046.018 \n#&gt; Residual Deviance: 1008.234  AIC: NA\n\n\nsummary(maper_model)\n#&gt; \n#&gt; Call:\n#&gt; glm(formula = maper ~ spei_12m * gdp_per_capita, family = quasibinomial(link = \"logit\"), \n#&gt;     data = data)\n#&gt; \n#&gt; Coefficients:\n#&gt;                                 Estimate       Std. Error    t value\n#&gt; (Intercept)             -3.5364766470774  0.0106686041904 -331.48447\n#&gt; spei_12m                -0.0578821582221  0.0211670993397   -2.73453\n#&gt; gdp_per_capita          -0.0000117537643  0.0000004997133  -23.52102\n#&gt; spei_12m:gdp_per_capita -0.0000055604975  0.0000010585039   -5.25317\n#&gt;                              Pr(&gt;|t|)    \n#&gt; (Intercept)                &lt; 2.22e-16 ***\n#&gt; spei_12m                    0.0062489 ** \n#&gt; gdp_per_capita             &lt; 2.22e-16 ***\n#&gt; spei_12m:gdp_per_capita 0.00000015006 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; (Dispersion parameter for quasibinomial family taken to be 0.0366800415)\n#&gt; \n#&gt;     Null deviance: 1046.0178  on 54669  degrees of freedom\n#&gt; Residual deviance: 1008.2344  on 54666  degrees of freedom\n#&gt;   (10331 observations deleted due to missingness)\n#&gt; AIC: NA\n#&gt; \n#&gt; Number of Fisher Scoring iterations: 7\n\nMPEPR – Thinness for Height (Magreza Por Estatura)\n\nmpepr_model &lt;- glm(\n  mpepr ~ spei_12m * gdp_per_capita,\n  data = data,\n  family = quasibinomial(link = \"logit\")\n)\n\nmpepr_model\n#&gt; \n#&gt; Call:  glm(formula = mpepr ~ spei_12m * gdp_per_capita, family = quasibinomial(link = \"logit\"), \n#&gt;     data = data)\n#&gt; \n#&gt; Coefficients:\n#&gt;             (Intercept)                 spei_12m           gdp_per_capita  \n#&gt;         -3.453653181925          -0.129070860970          -0.000007061586  \n#&gt; spei_12m:gdp_per_capita  \n#&gt;         -0.000002473331  \n#&gt; \n#&gt; Degrees of Freedom: 54669 Total (i.e. Null);  54666 Residual\n#&gt;   (10331 observations deleted due to missingness)\n#&gt; Null Deviance:       687.2864 \n#&gt; Residual Deviance: 661.839   AIC: NA\n\n\nsummary(mpepr_model)\n#&gt; \n#&gt; Call:\n#&gt; glm(formula = mpepr ~ spei_12m * gdp_per_capita, family = quasibinomial(link = \"logit\"), \n#&gt;     data = data)\n#&gt; \n#&gt; Coefficients:\n#&gt;                                 Estimate       Std. Error    t value\n#&gt; (Intercept)             -3.4536531819248  0.0055451302278 -622.82634\n#&gt; spei_12m                -0.1290708609697  0.0110714003091  -11.65804\n#&gt; gdp_per_capita          -0.0000070615864  0.0000002407524  -29.33132\n#&gt; spei_12m:gdp_per_capita -0.0000024733309  0.0000005202559   -4.75407\n#&gt;                             Pr(&gt;|t|)    \n#&gt; (Intercept)               &lt; 2.22e-16 ***\n#&gt; spei_12m                  &lt; 2.22e-16 ***\n#&gt; gdp_per_capita            &lt; 2.22e-16 ***\n#&gt; spei_12m:gdp_per_capita 0.0000019987 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; (Dispersion parameter for quasibinomial family taken to be 0.01240486978)\n#&gt; \n#&gt;     Null deviance: 687.28635  on 54669  degrees of freedom\n#&gt; Residual deviance: 661.83899  on 54666  degrees of freedom\n#&gt;   (10331 observations deleted due to missingness)\n#&gt; AIC: NA\n#&gt; \n#&gt; Number of Fisher Scoring iterations: 7"
  },
  {
    "objectID": "index.html#generalized-additive-model-mixed-effects-gamm",
    "href": "index.html#generalized-additive-model-mixed-effects-gamm",
    "title": "",
    "section": "Generalized Additive Model Mixed Effects (GAMM)",
    "text": "Generalized Additive Model Mixed Effects (GAMM)\nMBEPR – Very Short Stature for Age (Muito Baixa Estatura Para a Idade)\n\nCodedata &lt;-\n  data |&gt;\n  dplyr::mutate(\n    mbepr = pmax(0.0001, pmin(0.9999, mbepr))\n  )\n\n\n\nCodembepr_model_gamm &lt;- mgcv::gam(\n  mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\"), \n  data = data,\n  family = mgcv::betar(link = \"logit\")\n)\n\nmbepr_model_gamm\n#&gt; \n#&gt; Family: Beta regression(24.531) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Estimated degrees of freedom:\n#&gt; 8.89 0.00  total = 10.89 \n#&gt; \n#&gt; REML score: -106831.1863\n\n\n\nCodesummary(mbepr_model_gamm)\n#&gt; \n#&gt; Family: Beta regression(24.531) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.7027669847549  0.0063418020582 -426.18280 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000086801261  0.0000001794867  -48.36084 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 8.889552237951 8.996491 928.90218 &lt; 2.22e-16 ***\n#&gt; s(year)     0.000003234013 1.000000   0.00005 0.00019065 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0243   Deviance explained = 5.05%\n#&gt; -REML = -1.0683e+05  Scale est. = 1         n = 54670\n\n\n\nCodembepr_model_gamm |&gt; plot(pages = 1)\n\n\n\n\n\n\n\n\nCodembepr_model_gamm |&gt; coef_mean()\n#&gt; [1] -0.2619787413\n\n\n\nCodembepr_model_gamm |&gt; coef_spei12m_mean()\n#&gt; [1] -0.04899657958\n\n\n\nCodedata |&gt;\nplot_gamm(\n  model = mbepr_model_gamm,\n  title = paste0(\n    \"Very Short Stature for Age versus (MBEPR) versus \\n\", \n    \"Standardised Precipitation Evapotranspiration Index\"\n  ),\n  y_label = \"Predicted MBEPR\"\n)\n\n\n\n\n\n\n\nBEIPR – Short Stature for Age (Baixa Estatura Para Idade)\n\nCodedata &lt;-\n  data |&gt;\n  dplyr::mutate(\n    beipr = pmax(0.0001, pmin(0.9999, beipr))\n  )\n\n\n\nCodebeipr_model_gamm &lt;- mgcv::gam(\n  beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\"),\n  data = data,\n  family = mgcv::betar(link = \"logit\")\n)\n\nbeipr_model_gamm\n#&gt; \n#&gt; Family: Beta regression(35.93) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Estimated degrees of freedom:\n#&gt; 8.69 0.00  total = 10.69 \n#&gt; \n#&gt; REML score: -105270.0952\n\n\n\nCodesummary(beipr_model_gamm)\n#&gt; \n#&gt; Family: Beta regression(35.93) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.5588107330787  0.0083680633557 -305.78291 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000065235994  0.0000001544059  -42.24967 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 8.68890721298 8.972917 679.26856 &lt; 2.22e-16 ***\n#&gt; s(year)     0.00001312662 1.000000   0.00081 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0283   Deviance explained = 4.13%\n#&gt; -REML = -1.0527e+05  Scale est. = 1         n = 54670\n\n\n\nCodebeipr_model_gamm |&gt; plot(pages = 1)\n\n\n\n\n\n\n\n\nCodebeipr_model_gamm |&gt; coef_mean()\n#&gt; [1] -0.2643808837\n\n\n\nCodebeipr_model_gamm |&gt; coef_spei12m_mean()\n#&gt; [1] -0.06819482812\n\n\n\nCodedata |&gt;\nplot_gamm(\n  model = beipr_model_gamm,\n  title = paste0(\n    \"Short Stature for Age (BEIPR) versues \\n\",\n    \"Standardised Precipitation Evapotranspiration Index\"\n  ),\n  x_label = \"SPEI 12m\",\n  y_label = \"Predicted BEIPR\"\n)\n\n\n\n\n\n\n\nMAPER – Severe Thinness for Height (Magreza Acentuada Para a Estatura)\n\nCodedata &lt;-\n  data |&gt;\n  dplyr::mutate(\n    maper = pmax(0.0001, pmin(0.9999, maper))\n  )\n\n\n\nCodemaper_model_gamm &lt;- mgcv::gam(\n  maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\"),\n  data = data,\n  family = mgcv::betar(link = \"logit\")\n)\n\nmaper_model_gamm\n#&gt; \n#&gt; Family: Beta regression(37.008) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Estimated degrees of freedom:\n#&gt; 8.86 0.00  total = 10.86 \n#&gt; \n#&gt; REML score: -151474.9192\n\n\n\nCodesummary(maper_model_gamm)\n#&gt; \n#&gt; Family: Beta regression(37.008) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.5187320870973  0.0065372134986 -538.26177 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000110852034  0.0000001906241  -58.15216 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df     Chi.sq    p-value    \n#&gt; s(spei_12m) 8.864908270421 8.994767 1385.13687 &lt; 2.22e-16 ***\n#&gt; s(year)     0.000002548998 1.000000    0.00013 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0272   Deviance explained =  6.9%\n#&gt; -REML = -1.5147e+05  Scale est. = 1         n = 54670\n\n\n\nCodemaper_model_gamm |&gt; plot(pages = 1)\n\n\n\n\n\n\n\n\nCodemaper_model_gamm |&gt; coef_mean()\n#&gt; [1] -0.3810039149\n\n\n\nCodemaper_model_gamm |&gt; coef_spei12m_mean()\n#&gt; [1] -0.1170337536\n\n\n\nCodedata |&gt;\nplot_gamm(\n  model = maper_model_gamm,\n  title = paste0(\n    \"Severe Thinness for Height (MAPER) versus \\n\",\n    \"Standardised Precipitation Evapotranspiration Index\"\n  ),\n  y_label = \"Predicted MAPER\"\n)\n\n\n\n\n\n\n\nMPEPR – Thinness for Height (Magreza Por Estatura)\n\nCodedata &lt;-\n  data |&gt;\n  dplyr::mutate(\n    mpepr = pmax(0.0001, pmin(0.9999, mpepr))\n  )\n\n\n\nCodempepr_model_gamm &lt;- mgcv::gam(\n  mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\"),\n  data = data,\n  family = mgcv::betar(link = \"logit\")\n)\n\nmpepr_model_gamm\n#&gt; \n#&gt; Family: Beta regression(46.805) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Estimated degrees of freedom:\n#&gt; 8.88 0.00  total = 10.88 \n#&gt; \n#&gt; REML score: -143159.3615\n\n\n\nCodesummary(mpepr_model_gamm)\n#&gt; \n#&gt; Family: Beta regression(46.805) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.3850047188458  0.0062439242831 -542.1278 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000094624353  0.0000001793694  -52.7539 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df   Chi.sq p-value    \n#&gt; s(spei_12m) 8.88155042288 8.995962 2028.904 &lt; 2e-16 ***\n#&gt; s(year)     0.00000319169 1.000000    0.000 0.46573    \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0337   Deviance explained = 7.53%\n#&gt; -REML = -1.4316e+05  Scale est. = 1         n = 54670\n\n\n\nCodempepr_model_gamm |&gt; plot(pages = 1)\n\n\n\n\n\n\n\n\nCodempepr_model_gamm |&gt; coef_mean()\n#&gt; [1] -0.4039970943\n\n\n\nCodempepr_model_gamm |&gt; coef_spei12m_mean()\n#&gt; [1] -0.1625501059\n\n\n\nCodedata |&gt;\nplot_gamm(\n  model = mpepr_model_gamm,\n  title = paste0(\n    \"Thinness for Height (MPEPR) versus \\n\",\n    \"Standardised Precipitation Evapotranspiration Index\"\n  ),\n  y_label = \"Predicted MPEPR\"\n)\n\n\n\n\n\n\n\nModel Check\n\nCodemgcv::gam.check(mbepr_model_gamm)\n\n\n\n\n\n\n#&gt; \n#&gt; Method: REML   Optimizer: outer newton\n#&gt; full convergence after 5 iterations.\n#&gt; Gradient range [0.00002093215649,0.09068848415]\n#&gt; (score -106831.1863 & scale 1).\n#&gt; eigenvalue range [-0.00002093202182,24100.629].\n#&gt; Model rank =  12 / 12 \n#&gt; \n#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may\n#&gt; indicate that k is too low, especially if edf is close to k'.\n#&gt; \n#&gt;                     k'        edf k-index p-value  \n#&gt; s(spei_12m) 9.00000000 8.88955224    0.99   0.610  \n#&gt; s(year)     1.00000000 0.00000323    0.97   0.045 *\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCodemgcv::gam.check(beipr_model_gamm)\n\n\n\n\n\n\n#&gt; \n#&gt; Method: REML   Optimizer: outer newton\n#&gt; full convergence after 5 iterations.\n#&gt; Gradient range [-0.000215252209,0.0003964991776]\n#&gt; (score -105270.0952 & scale 1).\n#&gt; eigenvalue range [-0.0003964890913,25913.25923].\n#&gt; Model rank =  12 / 12 \n#&gt; \n#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may\n#&gt; indicate that k is too low, especially if edf is close to k'.\n#&gt; \n#&gt;                    k'       edf k-index p-value\n#&gt; s(spei_12m) 9.0000000 8.6889072    1.01    0.85\n#&gt; s(year)     1.0000000 0.0000131    0.98    0.17\n\n\nCodemgcv::gam.check(maper_model_gamm)\n\n\n\n\n\n\n#&gt; \n#&gt; Method: REML   Optimizer: outer newton\n#&gt; full convergence after 4 iterations.\n#&gt; Gradient range [0.00006354959436,0.01155840506]\n#&gt; (score -151474.9192 & scale 1).\n#&gt; eigenvalue range [-0.00006354927352,21016.01011].\n#&gt; Model rank =  12 / 12 \n#&gt; \n#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may\n#&gt; indicate that k is too low, especially if edf is close to k'.\n#&gt; \n#&gt;                     k'        edf k-index p-value\n#&gt; s(spei_12m) 9.00000000 8.86490827    1.01    0.71\n#&gt; s(year)     1.00000000 0.00000255    1.02    0.86\n\n\nCodemgcv::gam.check(mpepr_model_gamm)\n\n\n\n\n\n\n#&gt; \n#&gt; Method: REML   Optimizer: outer newton\n#&gt; full convergence after 4 iterations.\n#&gt; Gradient range [-0.000000700510767,0.01755277868]\n#&gt; (score -143159.3615 & scale 1).\n#&gt; Hessian positive definite, eigenvalue range [0.0000007005112393,23265.15506].\n#&gt; Model rank =  12 / 12 \n#&gt; \n#&gt; Basis dimension (k) checking results. Low p-value (k-index&lt;1) may\n#&gt; indicate that k is too low, especially if edf is close to k'.\n#&gt; \n#&gt;                     k'        edf k-index p-value\n#&gt; s(spei_12m) 9.00000000 8.88155042    1.01    0.89\n#&gt; s(year)     1.00000000 0.00000319    0.98    0.25"
  },
  {
    "objectID": "index.html#analysis-by-misfs",
    "href": "index.html#analysis-by-misfs",
    "title": "",
    "section": "Analysis by MISFS",
    "text": "Analysis by MISFS\nBy S(SPEI 12m) + GDP Per Capita + S(Year)\nMBEPR – Very Short Stature for Age (Muito Baixa Estatura Para a Idade)\n\nCodembepr_model_gamm_misfs_1 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = mbepr_model_gamm,\n    type = 1\n  )\n\n\n\nmbepr_model_gamm_misfs_1 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(24.413) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value         Pr(&gt;|z|)\n#&gt; (Intercept)    -2.7086722214888  0.0251079118483 -107.88122       &lt; 2.22e-16\n#&gt; gdp_per_capita -0.0000027789004  0.0000004522482   -6.14464 0.00000000080148\n#&gt;                   \n#&gt; (Intercept)    ***\n#&gt; gdp_per_capita ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df   Chi.sq     p-value    \n#&gt; s(spei_12m) 6.907630259034 8.023555 80.29324  &lt; 2.22e-16 ***\n#&gt; s(year)     0.000009175927 1.000000  0.00014 0.000077048 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00638   Deviance explained = 1.88%\n#&gt; -REML = -12621  Scale est. = 1         n = 6721\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(22.125) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                       Estimate      Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.035549328216  0.009437220353 -321.6571 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.000001868094  0.000000216192   -8.6409 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 8.185709219345 8.826234 114.10441 &lt; 2.22e-16 ***\n#&gt; s(year)     0.000002647121 1.000000   0.00002  0.0028869 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00115   Deviance explained = 0.636%\n#&gt; -REML = -59428  Scale est. = 1         n = 27944\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(44.041) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.6498919545521  0.0144212926778 -183.74857   &lt;2e-16 ***\n#&gt; gdp_per_capita -0.0000007112901  0.0000004455574   -1.59641   0.1104    \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf  Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 8.79678710055 8.98819 205.55764 &lt; 2.22e-16 ***\n#&gt; s(year)     0.00001311438 1.00000   0.00131 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0121   Deviance explained = 1.18%\n#&gt; -REML = -35016  Scale est. = 1         n = 17659\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(39.046) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.2130292815722  0.0398572683822 -55.52386 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000088877279  0.0000009970597  -8.91394 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df   Chi.sq    p-value    \n#&gt; s(spei_12m) 1.00108716051 1.002174 11.00261 0.00091716 ***\n#&gt; s(year)     0.00002191564 1.000000  0.00023 0.00115144 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.034   Deviance explained =    4%\n#&gt; -REML = -4102.3  Scale est. = 1         n = 2346\n\n\nmbepr_model_gamm_misfs_1 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nmbepr_model_gamm_misfs_1 |&gt; coef_spei12m_means_misfs()\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = mbepr_model_gamm_misfs_1,\n    title = \"Very Short Stature for Age (MBEPR) by MISFS\",\n    y_label = \"Predicted MBEPR\",\n    type = 1\n  )\n\n\n\n\n\n\n\nBEIPR – Short Stature for Age (Baixa Estatura Para Idade)\n\nCodebeipr_model_gamm_misfs_1 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = beipr_model_gamm,\n    type = 1\n  )\n\n\n\nbeipr_model_gamm_misfs_1 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(33.872) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value    Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.6183178600095  0.0242319981512 -108.05208  &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000016539806  0.0000003813088   -4.33764 0.000014402 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 7.84875841922 8.666477 161.36317 &lt; 2.22e-16 ***\n#&gt; s(year)     0.00001262858 1.000000   0.00115 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0151   Deviance explained = 2.68%\n#&gt; -REML = -12689  Scale est. = 1         n = 6721\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(32.684) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value         Pr(&gt;|z|)\n#&gt; (Intercept)    -2.8323627140074  0.0086247719049 -328.39856       &lt; 2.22e-16\n#&gt; gdp_per_capita -0.0000011254321  0.0000001797438   -6.26131 0.00000000038175\n#&gt;                   \n#&gt; (Intercept)    ***\n#&gt; gdp_per_capita ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df   Chi.sq      p-value    \n#&gt; s(spei_12m) 4.169516002121 5.191392 55.19505   &lt; 2.22e-16 ***\n#&gt; s(year)     0.000003964537 1.000000  0.00010 0.0000008686 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00232   Deviance explained = 0.34%\n#&gt; -REML = -56179  Scale est. = 1         n = 27944\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(82.194) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -2.5322023592576  0.0091352621940 -277.18989 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000012765615  0.0000003306047   -3.86129 0.00011279 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 8.662526874889 8.968023 121.74172 &lt; 2.22e-16 ***\n#&gt; s(year)     0.000009311943 1.000000   0.00029 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0106   Deviance explained = 0.802%\n#&gt; -REML = -38558  Scale est. = 1         n = 17659\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(59.763) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -1.8656879394534  0.0394343023213 -47.31130 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000072831416  0.0000007320574  -9.94887 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df   Chi.sq   p-value   \n#&gt; s(spei_12m) 1.00047904420 1.000958 10.21630 0.0013953 **\n#&gt; s(year)     0.00004385054 1.000000  0.00026 0.0158747 * \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0508   Deviance explained = 4.65%\n#&gt; -REML =  -4141  Scale est. = 1         n = 2346\n\n\nbeipr_model_gamm_misfs_1 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nbeipr_model_gamm_misfs_1 |&gt; coef_spei12m_means_misfs()\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = beipr_model_gamm_misfs_1,\n    title = \"Short Stature for Age (BEIPR) by MISFS\",\n    y_label = \"Predicted BEIPR\",\n    type = 1\n  )\n\n\n\n\n\n\n\nMAPER – Severe Thinness for Height (Magreza Acentuada Para a Estatura)\n\nCodemaper_model_gamm_misfs_1 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = maper_model_gamm,\n    type = 1\n  )\n\n\n\nmaper_model_gamm_misfs_1 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(33.407) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error   z value        Pr(&gt;|z|)\n#&gt; (Intercept)    -3.4874339100552  0.0195070801919 -178.7779      &lt; 2.22e-16\n#&gt; gdp_per_capita -0.0000029806451  0.0000004977948   -5.9877 0.0000000021283\n#&gt;                   \n#&gt; (Intercept)    ***\n#&gt; gdp_per_capita ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df   Chi.sq     p-value    \n#&gt; s(spei_12m) 5.460870605461 6.653486 32.32437 0.000030034 ***\n#&gt; s(year)     0.000002606773 1.000000  0.00002   0.0051981 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0035   Deviance explained = 1.14%\n#&gt; -REML = -17373  Scale est. = 1         n = 6721\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(33.321) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.8890807401487  0.0098061169347 -396.59743 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000033276989  0.0000002339366  -14.22479 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df    Chi.sq  p-value    \n#&gt; s(spei_12m) 8.13617255244 8.805671 246.73101  &lt; 2e-16 ***\n#&gt; s(year)     0.00000214972 1.000000   0.00001 0.019722 *  \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00601   Deviance explained =  1.4%\n#&gt; -REML = -86143  Scale est. = 1         n = 27944\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(62.482) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                       Estimate      Std. Error    z value Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.436883594232  0.010291548864 -333.95203  &lt; 2e-16 ***\n#&gt; gdp_per_capita -0.000000542129  0.000000507238   -1.06879  0.28517    \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df    Chi.sq    p-value    \n#&gt; s(spei_12m) 6.936506246539 8.043066 120.57074 &lt; 2.22e-16 ***\n#&gt; s(year)     0.000003473506 1.000000   0.00047 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00537   Deviance explained = 0.755%\n#&gt; -REML = -45685  Scale est. = 1         n = 17659\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(96.599) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error   z value     Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.4933442183346  0.0384152852640 -90.93631   &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000046079335  0.0000009507086  -4.84684 0.0000012544 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf  Ref.df  Chi.sq      p-value    \n#&gt; s(spei_12m) 1.23786573662 1.44072 0.12676      0.91803    \n#&gt; s(year)     0.00001716901 1.00000 0.00042 0.0000013159 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00818   Deviance explained = 1.16%\n#&gt; -REML = -6548.9  Scale est. = 1         n = 2346\n\n\nmaper_model_gamm_misfs_1 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nmaper_model_gamm_misfs_1 |&gt; coef_spei12m_means_misfs()\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = maper_model_gamm_misfs_1,\n    title = \"Severe Thinness for Height (MAPER) by MISFS\",\n    y_label = \"Predicted MAPER\",\n    type = 1\n  )\n\n\n\n\n\n\n\nMPEPR – Thinness for Height (Magreza Por Estatura)\n\nCodempepr_model_gamm_misfs_1 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = mpepr_model_gamm,\n    type = 1\n  )\n\n\n\nmpepr_model_gamm_misfs_1 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(44.225) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value     Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.3687440829323  0.0246335647481 -136.75423   &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000021283608  0.0000004427547   -4.80709 0.0000015314 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df   Chi.sq p-value    \n#&gt; s(spei_12m) 5.970719189065 7.173862 65.21956  &lt;2e-16 ***\n#&gt; s(year)     0.000009043833 1.000000  0.00002  0.1332    \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00253   Deviance explained = 1.41%\n#&gt; -REML = -16700  Scale est. = 1         n = 6721\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(37.503) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.6806629571423  0.0094521649778 -389.39893 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000025259286  0.0000002208273  -11.43848 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df    Chi.sq     p-value    \n#&gt; s(spei_12m) 8.579675779618 8.950963 521.69511  &lt; 2.22e-16 ***\n#&gt; s(year)     0.000002501037 1.000000   0.00005 0.000010739 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00796   Deviance explained = 2.15%\n#&gt; -REML = -77547  Scale est. = 1         n = 27944\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(109.854) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.3387629360220  0.0138461644147 -241.13269  &lt; 2e-16 ***\n#&gt; gdp_per_capita -0.0000011686712  0.0000003990934   -2.92831 0.003408 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                       edf   Ref.df   Chi.sq    p-value    \n#&gt; s(spei_12m) 7.38504143582 8.380703 97.23446 &lt; 2.22e-16 ***\n#&gt; s(year)     0.00001612837 1.000000  0.00249 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00699   Deviance explained = 0.647%\n#&gt; -REML = -48207  Scale est. = 1         n = 17659\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(128.082) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(spei_12m) + gdp_per_capita + s(year, bs = \"re\")\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                        Estimate       Std. Error    z value   Pr(&gt;|z|)    \n#&gt; (Intercept)    -3.3036765685165  0.0246968794470 -133.76899 &lt; 2.22e-16 ***\n#&gt; gdp_per_capita -0.0000019221267  0.0000006966528   -2.75909  0.0057963 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;                        edf   Ref.df  Chi.sq    p-value    \n#&gt; s(spei_12m) 1.002424084109 1.004844 0.08108 0.77843854    \n#&gt; s(year)     0.000009718337 1.000000 0.00013 0.00027477 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.00351   Deviance explained = 0.34%\n#&gt; -REML = -6506.5  Scale est. = 1         n = 2346\n\n\nmpepr_model_gamm_misfs_1 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nmpepr_model_gamm_misfs_1 |&gt; coef_spei12m_means_misfs()\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = mpepr_model_gamm_misfs_1,\n    title = \"Thinness for Height (MPEPR) by MISFS\",\n    y_label = \"Predicted MPEPR\",\n    type = 1\n  )\n\n\n\n\n\n\n\nOnly by S(Year)\nMBEPR – Very Short Stature for Age (Muito Baixa Estatura Para a Idade)\n\nCodembepr_model_gamm_misfs_2 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = mbepr_model_gamm,\n    type = 2\n  )\n\n\n\nmbepr_model_gamm_misfs_2 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(21.813) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.760548281  0.008408097 -328.3202 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 7.636547 8.537803 109.6488 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.0117   Deviance explained = 1.55%\n#&gt; -REML = -14802  Scale est. = 1         n = 8001\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(20.648) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.068052812  0.004517026 -679.2197 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf  Ref.df   Chi.sq    p-value    \n#&gt; s(year) 7.967059 8.72326 184.8139 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00213   Deviance explained = 0.595%\n#&gt; -REML = -70253  Scale est. = 1         n = 33201\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(39.594) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                Estimate  Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.61385934  0.00398162 -656.4814 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;             edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 8.13964 8.803401 449.4811 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0303   Deviance explained = 2.12%\n#&gt; -REML = -40355  Scale est. = 1         n = 21009\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(35.132) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mbepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                Estimate  Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.26649295  0.01021249 -221.9333 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf  Ref.df   Chi.sq    p-value    \n#&gt; s(year) 6.616444 7.75189 125.4656 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0429   Deviance explained = 4.53%\n#&gt; -REML = -4698.8  Scale est. = 1         n = 2790\n\n\nmbepr_model_gamm_misfs_2 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nCodesummarise_model_gamm_misfs_2(mbepr_model_gamm_misfs_2)\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = mbepr_model_gamm_misfs_2,\n    title = \"Very Short Stature for Age (MBEPR) by MISFS\",\n    x_label = \"Years\",\n    y_label = \"Predicted MBEPR\",\n    type = 2\n  )\n\n\n\n\n\n\n\nBEIPR – Short Stature for Age (Baixa Estatura Para Idade)\n\nCodebeipr_model_gamm_misfs_2 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = beipr_model_gamm,\n    type = 2\n  )\n\n\n\nbeipr_model_gamm_misfs_2 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(29.769) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error  z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.648751917  0.007303033 -362.692 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df  Chi.sq    p-value    \n#&gt; s(year) 6.529559 7.673822 147.148 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.0162   Deviance explained = 1.92%\n#&gt; -REML = -14767  Scale est. = 1         n = 8001\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(29.986) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.847493774  0.003799504 -749.4383 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf  Ref.df   Chi.sq    p-value    \n#&gt; s(year) 8.066288 8.77101 177.0859 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00791   Deviance explained = 0.587%\n#&gt; -REML = -65744  Scale est. = 1         n = 33201\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(74.565) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                Estimate  Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -2.51098479  0.00290845 -863.3411 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 7.426274 8.398473 562.5951 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0382   Deviance explained = 2.59%\n#&gt; -REML = -44659  Scale est. = 1         n = 21009\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(52.489) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; beipr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -1.924461480  0.007582017 -253.8192 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 3.601066 4.457232 66.45076 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.032   Deviance explained = 2.47%\n#&gt; -REML = -4742.4  Scale est. = 1         n = 2790\n\n\nbeipr_model_gamm_misfs_2 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nCodesummarise_model_gamm_misfs_2(beipr_model_gamm_misfs_2)\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = beipr_model_gamm_misfs_2,\n    title = \"Short Stature for Age (BEIPR) by MISFS\",\n    y_label = \"Predicted BEIPR\",\n    type = 2\n  )\n\n\n\n\n\n\n\nMAPER – Severe Thinness for Height (Magreza Acentuada Para a Estatura)\n\nCodemaper_model_gamm_misfs_2 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = maper_model_gamm,\n    type = 2\n  )\n\n\n\nmaper_model_gamm_misfs_2 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(30.163) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.528075401  0.009245944 -381.5809 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 6.073143 7.239167 43.63848 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00192   Deviance explained = 0.64%\n#&gt; -REML = -20507  Scale est. = 1         n = 8001\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(30.916) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.939262865  0.004881495 -806.9787 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 8.213052 8.834218 170.5708 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.000345   Deviance explained = 0.525%\n#&gt; -REML = -1.019e+05  Scale est. = 1         n = 33201\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(57.111) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.411791854  0.004535189 -752.2932 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 8.341086 8.881764 269.4013 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0154   Deviance explained = 1.38%\n#&gt; -REML = -53406  Scale est. = 1         n = 21009\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(90.106) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; maper ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                Estimate  Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.51658361  0.01083901 -324.4378 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 3.361261 4.168493 55.80129 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0261   Deviance explained = 2.21%\n#&gt; -REML =  -7679  Scale est. = 1         n = 2790\n\n\nmaper_model_gamm_misfs_2 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nCodesummarise_model_gamm_misfs_2(maper_model_gamm_misfs_2)\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = maper_model_gamm_misfs_2,\n    title = \"Severe Thinness for Height (MAPER) by MISFS\",\n    y_label = \"Predicted MAPER\",\n    type = 2\n  )\n\n\n\n\n\n\n\nMPEPR – Thinness for Height (Magreza Por Estatura)\n\nCodempepr_model_gamm_misfs_2 &lt;- \n  data |&gt; \n  model_gamm_misfs(\n    model = mpepr_model_gamm,\n    type = 2\n  )\n\n\n\nmpepr_model_gamm_misfs_2 |&gt; summarise_model_gamm_misfs()\n#&gt; \n#&gt; ── Model A ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(39.693) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.412541413  0.008316807 -410.3187 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 5.513303 6.660799 92.81762 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.0187   Deviance explained = 1.23%\n#&gt; -REML = -19723  Scale est. = 1         n = 8001\n#&gt; \n#&gt; ── Model B ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(34.92) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.725866332  0.004572887 -814.7733 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df  Chi.sq    p-value    \n#&gt; s(year) 8.256788 8.851361 335.879 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  -0.00327   Deviance explained = 0.97%\n#&gt; -REML = -91740  Scale est. = 1         n = 33201\n#&gt; \n#&gt; ── Model C ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(98.152) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                 Estimate   Std. Error   z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.335865028  0.003554644 -938.4527 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq    p-value    \n#&gt; s(year) 5.922402 7.086925 151.7835 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0133   Deviance explained = 0.766%\n#&gt; -REML = -56263  Scale est. = 1         n = 21009\n#&gt; \n#&gt; ── Model D ──────────────────────────────────────────────────────────────────\n#&gt; \n#&gt; Family: Beta regression(123.387) \n#&gt; Link function: logit \n#&gt; \n#&gt; Formula:\n#&gt; mpepr ~ s(year)\n#&gt; \n#&gt; Parametric coefficients:\n#&gt;                Estimate  Std. Error  z value   Pr(&gt;|z|)    \n#&gt; (Intercept) -3.31792430  0.00876765 -378.428 &lt; 2.22e-16 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; Approximate significance of smooth terms:\n#&gt;              edf   Ref.df   Chi.sq     p-value    \n#&gt; s(year) 2.625175 3.266502 22.89967 0.000070824 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; \n#&gt; R-sq.(adj) =  0.0108   Deviance explained = 0.925%\n#&gt; -REML = -7695.9  Scale est. = 1         n = 2790\n\n\nmpepr_model_gamm_misfs_2 |&gt; coef_means_misfs()\n\n\n  \n\n\n\n\nCodesummarise_model_gamm_misfs_2(mpepr_model_gamm_misfs_2)\n\n\n  \n\n\n\n\nCodedata |&gt;\n  plot_gamm_misfs(\n    gamm_models = mpepr_model_gamm_misfs_2,\n    title = \"Thinness for Height (MPEPR) by MISFS\",\n    y_label = \"Predicted MPEPR\",\n    type = 2\n  )"
  },
  {
    "objectID": "index.html#acknowledgments",
    "href": "index.html#acknowledgments",
    "title": "",
    "section": "Acknowledgments",
    "text": "Acknowledgments\n\nThis analysis is part of the Sustentarea Research and Extension Group’s project: Global syndemic: the impact of anthropogenic climate change on the health and nutrition of children under five years old attended by Brazil’s public health system (SUS).\n\nThis research was supported by the Conselho Nacional de Desenvolvimento Científico e Tecnológico - Brazil (CNPq)."
  },
  {
    "objectID": "index.html#references",
    "href": "index.html#references",
    "title": "",
    "section": "References",
    "text": "References\n\n\nWickham, H., Çetinkaya-Rundel, M., & Grolemund, G. (2023). R for data science: Import, tidy, transform, visualize, and model data (2nd ed.). O’Reilly Media. https://r4ds.hadley.nz"
  }
]